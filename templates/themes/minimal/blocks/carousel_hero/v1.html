{% load wagtailimages_tags %}
<section class="carousel-hero-section" {% if self.section_id %}id="{{ self.section_id }}" {% endif %}>
    <div class="swiper hero-swiper">
        <div class="swiper-wrapper">
            {% for slide in self.slides %}
            {% if slide.enabled %}
            <div class="swiper-slide">
                {% if slide.image %}
                {% image slide.image fill-1920x900 as slide_img %}
                <div class="slide-bg" style="background-image:url('{{ slide_img.url }}');">
                {% else %}
                <div class="slide-bg slide-default">
                {% endif %}
                        {% if slide.overlay %}<div class="hero-overlay"></div>{% endif %}
                        {% if slide.background_video_url %}
                        <video class="hero-video" autoplay muted loop playsinline>
                            <source src="{{ slide.background_video_url }}" type="video/mp4">
                        </video>
                        {% endif %}
                        <div class="container slide-inner">
                            {% if slide.badge_text %}
                            <div class="hero-badge"><i class="fa-solid fa-shield-halved"></i> {{ slide.badge_text }}
                            </div>
                            {% endif %}
                            {% if forloop.first %}<h1>{{ slide.title }}</h1>{% else %}<h2 class="slide-h2">{{
                                slide.title }}</h2>{% endif %}
                            {% if slide.subtitle %}<p class="hero-subtitle">{{ slide.subtitle }}</p>{% endif %}
                            <div class="hero-actions">
                                {% if slide.cta_text %}<a href="{{ slide.cta_link }}" class="btn btn-primary"><i
                                        class="fa-solid fa-arrow-right"></i> {{ slide.cta_text }}</a>{% endif %}
                                {% if slide.secondary_cta_text %}<a href="{{ slide.secondary_cta_link }}"
                                    class="btn btn-secondary"><i class="fa-solid fa-phone"></i> {{
                                    slide.secondary_cta_text }}</a>{% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
            {% if self.show_arrows %}<div class="swiper-button-next"></div>
            <div class="swiper-button-prev"></div>{% endif %}
            {% if self.show_dots %}<div class="swiper-pagination"></div>{% endif %}
        </div>
</section>

<style>
    .carousel-hero-section { padding: 0; }
    .hero-swiper { width: 100%; }
    .slide-bg { position: relative; min-height: 85vh; display: flex; align-items: center; background-size: cover; background-position: center; }
    .slide-default { background: linear-gradient(135deg, #0A0E17 0%, #1a1f2e 50%, #0A0E17 100%); }
    .hero-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: linear-gradient(135deg, rgba(0, 0, 0, 0.8), rgba(0, 0, 0, 0.4)); }
    .hero-video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0; }
    .slide-inner { position: relative; z-index: 2; padding: 120px 0; }
    .hero-badge { display: inline-flex; align-items: center; gap: 8px; background: rgba(0, 212, 255, 0.1); border: 1px solid rgba(0, 212, 255, 0.3); color: var(--primary); padding: 8px 20px; border-radius: 50px; font-size: 0.85rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 24px; }
    .carousel-hero-section h1, .slide-h2 { font-size: clamp(2.5rem, 5vw, 4.5rem); font-weight: 800; line-height: 1.1; margin-bottom: 20px; max-width: 800px; color: #fff; }
    .hero-subtitle { font-size: clamp(1rem, 2vw, 1.3rem); color: var(--text-muted); max-width: 600px; margin-bottom: 40px; }
    .hero-actions { display: flex; gap: 16px; flex-wrap: wrap; }
    .swiper-button-next, .swiper-button-prev { color: var(--primary) !important; }
    .swiper-pagination-bullet { background: var(--primary) !important; }
    .swiper-pagination-bullet-active { opacity: 1 !important; }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        if (typeof Swiper !== 'undefined') {
            new Swiper('.hero-swiper', {
                loop: true,
                effect: '{{ self.animation_type|default:"fade" }}',
                speed: {{ self.animation_speed|default:800 }},
                autoplay: {% if self.autoplay %}{ delay: {{ self.autoplay_speed|default:5000 }}, disableOnInteraction: false, pauseOnMouseEnter: {{ self.pause_on_hover|yesno:"true,false" }} }{% else %}false{% endif %},
                pagination: { el: '.swiper-pagination', clickable: true },
                navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
                lazy: { loadPrevNext: true },
            });
        }
    });
</script>